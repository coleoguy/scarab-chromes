# XY to other
if (i > (rng.len*2)){
# to Neo
if (j <= rng.len){
if (i == j + (rng.len*2) + 1){
chrom.mat[i,j] <- 12
}
}
# to XO
if (j > rng.len & j <= (rng.len*2)){
if (j + rng.len == i) {
chrom.mat[i,j] <- 9
}
}
# to XY
if (j > (rng.len*2)){
if (j == i+1 ){
chrom.mat[i,j] <- 5
}
if (j +1 == i ){
chrom.mat[i,j] <- 6
}
}
}
}
}
rownames(chrom.mat) <- colnames(chrom.mat) <- 1:51
# make sim state
chrom$sim.state <- NA
for (i in 1:length(chrom$SCS)){
if (chrom$SCS[i] == 'NeoXY'){
chrom$sim.state[i] <- chrom$Chroms[i] - rng[1] +1
}
if (chrom$SCS[i] == 'XO'){
chrom$sim.state[i] <- chrom$Chroms[i] + (rng.len) - rng[1]+1
}
if (chrom$SCS[i] == 'XY'){
chrom$sim.state[i] <- chrom$Chroms[i] + (rng.len*2) - rng[1]+1
}
}
x <- matrix(0,  nrow=nrow(chrom), rng.len*3)
rownames(x) <- chrom$Species
for(i in 1:nrow(x)){
x[i, chrom$sim.state[i]] <- 1
}
colnames(x) <- 1:(rng.len*3)
test <- make.simmap2(tree, x = x, model = chrom.mat, pi = 'fitzjohn', nsim = 1,rejmax = 1000000,rejint = 100000, monitor = T )
test <- make.simmap2(tree, x = x, model = chrom.mat, pi = 'fitzjohn', nsim = 1000,rejmax = 1000000,rejint = 100000, monitor = T )
test <- test[1:100]
#
counts <- describe.simmap2(test)$count
## AA fusion (desc)
# need column names
need.col <- c()
for (i in 2:rng.len){
need.col <- c(need.col,paste(i,i-1, sep = ','))
}
for (i in 19:(rng.len*2)){
need.col <- c(need.col,paste(i,i-1, sep = ','))
}
for (i in 36:(rng.len*3)){
need.col <- c(need.col,paste(i,i-1, sep = ','))
}
colnames(counts)[which(colnames(counts) %in% need.col,T)]
AAfusion <- rowSums(counts[,which(colnames(counts) %in% need.col,T)])
## SAfusion
need.col <- c()
for (i in (rng.len+1+1):(rng.len*2)){
need.col <- c(need.col,paste(i,i-18, sep = ','))
}
for (i in 36:51){
need.col <- c(need.col,paste(i,i-35,sep = ','))
}
for (i in 19:34){
need.col <- c(need.col,paste(i,i+16, sep = ','))
}
colnames(counts)[which(colnames(counts) %in% need.col,T)]
SAfusion <- rowSums(counts[,which(colnames(counts) %in% need.col,T)])
totalfusion <- rowSums(counts[,colnames(counts)])
obspropSA <- SAfusion / (SAfusion + AAfusion)
expSA <- c()
test
plotSimmap(test)
sim <- 100
sim
make.simmap2(tree, x = x, model = chrom.mat, pi = 'fitzjohn', nsim = sim,rejmax = 1000000,rejint = 100000, monitor = T )
#
counts <- describe.simmap2(test)$count
## AA fusion (desc)
# column that are fusions
need.col <- c()
for (i in 2:rng.len){
need.col <- c(need.col,paste(i,i-1, sep = ','))
}
for (i in 19:(rng.len*2)){
need.col <- c(need.col,paste(i,i-1, sep = ','))
}
for (i in 36:(rng.len*3)){
need.col <- c(need.col,paste(i,i-1, sep = ','))
}
counts
need.col
colnames(counts)[which(colnames(counts) %in% need.col,T)]
AAfusion <- rowSums(counts[,which(colnames(counts) %in% need.col,T)])
## SAfusion
need.col <- c()
for (i in (rng.len+1+1):(rng.len*2)){
need.col <- c(need.col,paste(i,i-18, sep = ','))
}
for (i in 36:51){
need.col <- c(need.col,paste(i,i-35,sep = ','))
}
for (i in 19:34){
need.col <- c(need.col,paste(i,i+16, sep = ','))
}
SAfusion <- rowSums(counts[,which(colnames(counts) %in% need.col,T)])
totalfusion <- rowSums(counts[,colnames(counts)])
totalfusion
SAfusion + AAfusion
totalfusion <- rowSums(counts[,colnames(counts)])
obspropSA <- SAfusion / (SAfusion + AAfusion)
expSA <- c()
for(i in 1:100){
print(i)
times <- describe.simmap(test[[i]])$times[2, ]
expSA[i] <- sum(Pfsa(Da =  6, scs = "XY") * times[c(1, 35)],
Pfsa(Da =  8, scs = "XY") * times[c(2, 36)],
Pfsa(Da = 10, scs = "XY") * times[c(3, 37)],
Pfsa(Da = 12, scs = "XY") * times[c(4, 38)],
Pfsa(Da = 14, scs = "XY") * times[c(5, 39)],
Pfsa(Da = 16, scs = "XY") * times[c(6, 40)],
Pfsa(Da = 18, scs = "XY") * times[c(7, 41)],
Pfsa(Da = 20, scs = "XY") * times[c(8, 42)],
Pfsa(Da = 22, scs = "XY") * times[c(9, 43)],
Pfsa(Da = 24, scs = "XY") * times[c(10, 44)],
Pfsa(Da = 26, scs = "XY") * times[c(11, 45)],
Pfsa(Da = 28, scs = "XY") * times[c(12, 46)],
Pfsa(Da = 30, scs = "XY") * times[c(13, 47)],
Pfsa(Da = 32, scs = "XY") * times[c(14, 48)],
Pfsa(Da = 36, scs = "XY") * times[c(15, 50)],
Pfsa(Da = 38, scs = "XY") * times[c(16, 51)],
#XO
Pfsa(Da =  7, scs = "XO") * times[18],
Pfsa(Da =  9, scs = "XO") * times[19],
Pfsa(Da = 11, scs = "XO") * times[20],
Pfsa(Da = 13, scs = "XO") * times[21],
Pfsa(Da = 15, scs = "XO") * times[22],
Pfsa(Da = 17, scs = "XO") * times[23],
Pfsa(Da = 19, scs = "XO") * times[24],
Pfsa(Da = 21, scs = "XO") * times[25],
Pfsa(Da = 23, scs = "XO") * times[26],
Pfsa(Da = 25, scs = "XO") * times[27],
Pfsa(Da = 27, scs = "XO") * times[28],
Pfsa(Da = 29, scs = "XO") * times[29],
Pfsa(Da = 31, scs = "XO") * times[30],
Pfsa(Da = 33, scs = "XO") * times[31],
Pfsa(Da = 35, scs = "XO") * times[32],
Pfsa(Da = 37, scs = "XO") * times[33],
Pfsa(Da = 39, scs = "XO") * times[34]
)
}
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion sex-autosome fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
points(x=0.55,y=37, pch =16, col = cols[1])
text(x=0.55,y=37, pos = 4, labels = "Expected", cex = 0.8)
points(x=0.55,y=34, pch =16, col = cols[2])
text(x=0.55,y=34, pos = 4, labels = "Inferred", cex = 0.8)
HPDinterval(as.mcmc(obspropSA))
HPDinterval(as.mcmc(expSA))
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion sex-autosome fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.5
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion sex-autosome fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.53
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
HPDinterval(as.mcmc(obspropSA))
HPDinterval(as.mcmc(expSA))
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion sex-autosome fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.54
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
HPDinterval(as.mcmc(obspropSA))
HPDinterval(as.mcmc(expSA))
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.54
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
HPDinterval(as.mcmc(obspropSA))
HPDinterval(as.mcmc(expSA))
obspropSA <- SAfusion / totalfusion
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.54
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
HPDinterval(as.mcmc(obspropSA))
HPDinterval(as.mcmc(expSA))
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
density(obspropSA)
plot(density(obspropSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
help("evobiR")
obspropSA <- SAfusion / totalfusion
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
plot(density(expSA, bw = .01),
xlim = c(0, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
obspropSA <- SAfusion / (SAfusion + AAfusion)
expSA <- c()
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(0.15, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(0.15, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
obspropSA <- SAfusion / (SAfusion + AAfusion)
expSA <- c()
for(i in 1:100){
print(i)
times <- describe.simmap(test[[i]])$times[2, ]
expSA[i] <- sum(Pfsa(Da =  6, scs = "XY") * times[c(1, 35)],
Pfsa(Da =  8, scs = "XY") * times[c(2, 36)],
Pfsa(Da = 10, scs = "XY") * times[c(3, 37)],
Pfsa(Da = 12, scs = "XY") * times[c(4, 38)],
Pfsa(Da = 14, scs = "XY") * times[c(5, 39)],
Pfsa(Da = 16, scs = "XY") * times[c(6, 40)],
Pfsa(Da = 18, scs = "XY") * times[c(7, 41)],
Pfsa(Da = 20, scs = "XY") * times[c(8, 42)],
Pfsa(Da = 22, scs = "XY") * times[c(9, 43)],
Pfsa(Da = 24, scs = "XY") * times[c(10, 44)],
Pfsa(Da = 26, scs = "XY") * times[c(11, 45)],
Pfsa(Da = 28, scs = "XY") * times[c(12, 46)],
Pfsa(Da = 30, scs = "XY") * times[c(13, 47)],
Pfsa(Da = 32, scs = "XY") * times[c(14, 48)],
Pfsa(Da = 36, scs = "XY") * times[c(15, 50)],
Pfsa(Da = 38, scs = "XY") * times[c(16, 51)],
#XO
Pfsa(Da =  7, scs = "XO") * times[18],
Pfsa(Da =  9, scs = "XO") * times[19],
Pfsa(Da = 11, scs = "XO") * times[20],
Pfsa(Da = 13, scs = "XO") * times[21],
Pfsa(Da = 15, scs = "XO") * times[22],
Pfsa(Da = 17, scs = "XO") * times[23],
Pfsa(Da = 19, scs = "XO") * times[24],
Pfsa(Da = 21, scs = "XO") * times[25],
Pfsa(Da = 23, scs = "XO") * times[26],
Pfsa(Da = 25, scs = "XO") * times[27],
Pfsa(Da = 27, scs = "XO") * times[28],
Pfsa(Da = 29, scs = "XO") * times[29],
Pfsa(Da = 31, scs = "XO") * times[30],
Pfsa(Da = 33, scs = "XO") * times[31],
Pfsa(Da = 35, scs = "XO") * times[32],
Pfsa(Da = 37, scs = "XO") * times[33],
Pfsa(Da = 39, scs = "XO") * times[34]
)
}
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.6), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.54
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.56), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.54
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.56), main = "",
xlab = "Proportion Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.5
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
HPDinterval(as.mcmc(obspropSA))
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.56), main = "",
xlab = "Proportion of Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.5
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.56), main = "",
xlab = "Proportion of Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.5
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
hpd <- HPDinterval(as.mcmc(obspropSA))
lines(y=c(-1,-1), x=hpd[1:2], lwd=2,col=cols[2])
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.56), main = "",
xlab = "Proportion of Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.5
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
hpd <- HPDinterval(as.mcmc(obspropSA))
lines(y=c(-0.5,-0.5), x=hpd[1:2], lwd=2,col=cols[2])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
hpd <- HPDinterval(as.mcmc(expSA))
lines(y=c(-0.5,-0.5), x=hpd[1:2], lwd=2,col=cols[1])
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.56), main = "",
xlab = "Proportion of Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.5
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
hpd <- HPDinterval(as.mcmc(expSA))
lines(y=c(-0.5,-0.5), x=hpd[1:2], lwd=2,col=cols[1])
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
hpd <- HPDinterval(as.mcmc(obspropSA))
lines(y=c(-0.5,-0.5), x=hpd[1:2], lwd=2,col=cols[2])
SAfusion + AAfusion
totalfusion
# plot
cols <- viridis(2, begin = 0.5, alpha = 0.65)
plot(density(expSA, bw = .01),
xlim = c(.15, 0.56), main = "",
xlab = "Proportion of Sex-Autosome Fusion",
cex.axis = .7, cex.lab = .7)
polygon(density(expSA, bw = .01),
col = cols[1])
lines(density(obspropSA))
polygon(density(obspropSA),
col = cols[2])
x=0.5
points(x=x,y=40, pch =16, col = cols[1])
text(x=x,y=40, pos = 4, labels = "Expected", cex = 0.8)
hpd <- HPDinterval(as.mcmc(expSA))
lines(y=c(-0.5,-0.5), x=hpd[1:2], lwd=2,col=cols[1])
points(x=x,y=38, pch =16, col = cols[2])
text(x=x,y=38, pos = 4, labels = "Inferred", cex = 0.8)
hpd <- HPDinterval(as.mcmc(obspropSA))
lines(y=c(-0.5,-0.5), x=hpd[1:2], lwd=2,col=cols[2])
expSA
